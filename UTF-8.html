<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>FORM MAILER v0.7 送信フォーム</title>
<style type="text/css">
* {
    font-family: "Lucida Grande", "Hiragino Kaku Gothic ProN", Meiryo, sans-serif;
    font-size: 13px;
    line-height: 140%;
}
fieldset {
	padding: 0;
	margin: 0;
	border: 0;
}
.main {
    padding: 0 30px 0 30px;
}
.footer {
    padding: 0 25px 0 25px;
    text-align: right;
    font-size:9pt;
    font-family: Verdana;
    font-weight: bold; 
}
body {
    margin: 0px;
    margin-top: 0px;
    font-size:10pt;
}
h2 {
    font-size: 14pt;
    font-family: Verdana;
    font-weight: bold;
}
hr {
    border: 1px #666666 solid;
}
tt,pre {
    font-size: 11pt;
    font-family:"Courier New";
    color: brown;
}
.btn_delete {
	cursor : pointer;
}
</style>
<script type="text/javascript" src="js/jquery-1.9.1.js"></script>
<script type="text/javascript" src="js/sprintf.js"></script>
<script type="text/javascript">
<!--
$(function () {

	$(".btn_submit").on("click", function () {
		$("#f0").attr("target", "_self");
		$("#f0").attr("enctype", "application/x-www-form-urlencoded");
		$("#ajax_action").attr("name", "dummy").attr("value", "");
		$("#f0").submit();
	});

	$("fieldset").on("change", "input[type=file]", function () {
		var name = $(this).attr("name");
		$("#f0").attr("target", "if");
		$("#f0").attr("enctype", "multipart/form-data");
		$("#ajax_action").attr("name", "ajax_upload").attr("value", name);
		$("#f0").submit();
	});

	$("fieldset").on("click", ".btn_delete", function() {
		var name = $(this).attr("id").match(/^btn_delete-(.+)$/)[1];
		$("#f0").attr("target", "if");
		$("#f0").attr("enctype", "application/x-www-form-urlencoded");
		$("#ajax_action").attr("name", "ajax_delete").attr("value", name);
		$("#f0").submit();
	});

/*
	$(".btn_test_on").on("click", function () {
		$(".btn_test_on").hide();
		$(".btn_test_off").show();
		$("#att_test").hide();
		$("#att_test").next("span").remove();
		$("#att_test").after("<span>ONの状態<\/span>");
	});
	$(".btn_test_off").on("click", function () {
		$(".btn_test_off").hide();
		$(".btn_test_on").show();
		$("#att_test").show();
		$("#att_test").next("span").remove();
	});
*/
	file_check();

});

function file_check() {

	$.ajax({
		type: "POST",
		url: "f_mailer.cgi",
		dataType: "json",
		async: false,
		data: {
			"CONFID" : $("#CONFID").val(),
			"TEMP" : $("#TEMP").val(),
			"ajax_file_check"  : 1
		},
		error: function(XMLHttpRequest, textStatus, errorThrown) {
			alert(textStatus);
                },
		success: function(d) {

			$.each(d, function(k, v) {
				if (k == "__TOTAL__") return true;
				if (v.size > 0) {
					$("#"+k).hide();
					$("#"+k).next("span").remove();
					$("#"+k).after("<span>"
						+ (
							v.size > 1024 * 1024 ? sprintf("%s (%.1fMバイト)", v.name, v.size / 1024 / 1024)
							: v.size > 1024 ? sprintf("%s (%.1fKバイト)", v.name, v.size / 1024)
							: sprintf("%s (%dバイト)", v.name, v.size)
						)
						+ '　<input type="button" value="削除" id="btn_delete-'
						+ k + '" class="btn_delete" \/><\/span>' 
					);

				} else {
					$("#"+k).next("span").remove();
					$("#"+k).replaceWith($("#"+k).clone());
					$("#"+k).show();
				}
			});
			$("#TEMP").val(d.TEMP);
		}
	}); 

}

function upload_complete () {
	file_check();

}
// -->
</script>
</head>
<body>
<iframe src="dummy.html" id="if" name="if" style="display:none"></iframe>
<div class="main">
<h2>FORM MAILER v0.7 送信フォーム</h2>
<!--errmsg-->
<form action="f_mailer.cgi" method="post" id="f0" enctype="multipart/form-data">
<fieldset>
<input type="hidden" name="GETCODE" value="文字コード" />
<input type="hidden" name="CONFID" value="sample" id="CONFID" />
<input type="hidden" name="TEMP" value="" id="TEMP" />
<input type="hidden" name="dummy" value="" id="ajax_action" />

メールアドレスを入力してください(必須) :<br />
<input type="text" name="EMAIL" size="40" style="ime-mode:inactive" /><br />
<input type="text" name="EMAIL2" size="40" style="ime-mode:inactive" />(もう一度)<br />
<br />
名前を入力してください(必須) :<br />
<input type="text" name="name" size="20" style="ime-mode:active" /><br /><br />

フリガナを入力してください(必須、全角カタカナのみ) :<br />
<input type="text" name="kana" /><br /><br />

性別を入力してください(必須) :<br />
<input type="radio" name="sex" value="男性" />男性　
<input type="radio" name="sex" value="女性" />女性<br /><br />

郵便番号を入力してください(必須、半角数字7ケタ) :<br />
<input type="text" name="pcode" size="8" style="ime-mode:inactive" /><br /><br />

住所を入力してください(必須) :<br />
<input type="text" name="addr" size="50" style="ime-mode:active" /><br /><br />

電話番号を入力してください(必須、0～9とハイフン(-)のみ使用可) :<br />
<input type="text" name="tel" /><br /><br />


機種依存文字を入力してみてください。エラーとなります :<br />
<input type="text" name="rel" /><br /><br />

URLを入力してください :<br />
<input type="text" name="url" /><br /><br />

クイズの問1の答えを入力してください(複数選択可/3つまで) :<br />
<input type="checkbox" name="q1" value="りんご" />りんご　
<input type="checkbox" name="q1" value="もも" />もも　
<input type="checkbox" name="q1" value="みかん" />みかん　
<input type="checkbox" name="q1" value="バナナ" />バナナ　
<input type="checkbox" name="q1" value="梨" />梨　
<input type="checkbox" name="q1" value="ぶどう" />ぶどう<br /><br />

予想得点を入力してください。(25～75の間):
<input type="text" name="pts" size="4" style="ime-mode:inactive" /><br /><br />

感想を入力してください :<br />
<textarea name="message" cols="70" rows="5" style="ime-mode:active"></textarea><br /><br />

ファイルを送ることができます(1ファイル最大512kb、合計1536kb)。 :<br />
<input type="file" name="att1" size="60" id="att1" /><br />
<input type="file" name="att2" size="60" id="att2" /><br />
<input type="file" name="att3" size="60" id="att3" />


<p>
	<input type="checkbox" name="SEND_FORCED" value="1" />確認画面を出さずに送信<br />
	<input type="button" value="送　信" class="btn_submit" />
</p>


<input type="button" value="ON" class="btn_test_on" />
<input type="button" value="OFF" class="btn_test_off" /><br />
<input type="file" name="att_test" size="60" id="att_test" />


</fieldset>
</form>
</div>
<div style="background: #ddd; font-family: Verdana, Arial, sans-serif; font-size: 8.5pt; color: #333; border-top: 0px dotted #999; border-bottom: 0px dotted #999; margin: 30px 0px 0px 0px; padding-right: 30px; text-align: right;">
<a href="http://www.psl.ne.jp"><b>FORM MAILER v0.7</b></a>
</div>
</body>
</html>
